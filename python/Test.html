<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Test | 学习笔记</title>
    <meta name="generator" content="VuePress 1.5.3">
    <link rel="icon" href="/img/logo.ico">
    <link rel="manifest" href="/manifest.json"><link rel='canonical' href='https://bugwriter2.github.io/python/Test.html'/>
    <meta name="description" content="博客">
    <meta name="google-site-verification" content="PXbr-y9acmnnEmw1zgCFEydL32xlZIf1OfFmzDFUrzI">
    <link rel="preload" href="/assets/css/0.styles.9ce6ac63.css" as="style"><link rel="preload" href="/assets/js/app.3fa2a2e1.js" as="script"><link rel="preload" href="/assets/js/2.057925ea.js" as="script"><link rel="preload" href="/assets/js/35.2828b1d3.js" as="script"><link rel="prefetch" href="/assets/js/10.9a53695e.js"><link rel="prefetch" href="/assets/js/11.e6f60bd9.js"><link rel="prefetch" href="/assets/js/12.90f3d785.js"><link rel="prefetch" href="/assets/js/13.42e681ed.js"><link rel="prefetch" href="/assets/js/14.7a85d7cd.js"><link rel="prefetch" href="/assets/js/15.402110d9.js"><link rel="prefetch" href="/assets/js/16.776ab4c1.js"><link rel="prefetch" href="/assets/js/17.4af5340c.js"><link rel="prefetch" href="/assets/js/18.bd060f5e.js"><link rel="prefetch" href="/assets/js/19.ac40939f.js"><link rel="prefetch" href="/assets/js/20.ac68ccd2.js"><link rel="prefetch" href="/assets/js/21.90d4b479.js"><link rel="prefetch" href="/assets/js/22.044d8e2b.js"><link rel="prefetch" href="/assets/js/23.606676bb.js"><link rel="prefetch" href="/assets/js/24.e8a14162.js"><link rel="prefetch" href="/assets/js/25.ebdc5e35.js"><link rel="prefetch" href="/assets/js/26.efd6b8fb.js"><link rel="prefetch" href="/assets/js/27.649d5e23.js"><link rel="prefetch" href="/assets/js/28.1c7ccf18.js"><link rel="prefetch" href="/assets/js/29.f0ca98d8.js"><link rel="prefetch" href="/assets/js/3.7c0ca1fc.js"><link rel="prefetch" href="/assets/js/30.540536d8.js"><link rel="prefetch" href="/assets/js/31.3cc7b8a3.js"><link rel="prefetch" href="/assets/js/32.02879a8f.js"><link rel="prefetch" href="/assets/js/33.b1417b92.js"><link rel="prefetch" href="/assets/js/34.0b5079cd.js"><link rel="prefetch" href="/assets/js/36.d0d0971a.js"><link rel="prefetch" href="/assets/js/37.6cc365c3.js"><link rel="prefetch" href="/assets/js/38.a184b552.js"><link rel="prefetch" href="/assets/js/39.84a689f9.js"><link rel="prefetch" href="/assets/js/4.7a06b201.js"><link rel="prefetch" href="/assets/js/40.c2d886c6.js"><link rel="prefetch" href="/assets/js/5.0de0ba0e.js"><link rel="prefetch" href="/assets/js/6.cb2a4e71.js"><link rel="prefetch" href="/assets/js/7.f7f97492.js"><link rel="prefetch" href="/assets/js/8.7c626f1f.js"><link rel="prefetch" href="/assets/js/9.b014d1e7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9ce6ac63.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">学习笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="博文" class="dropdown-title"><span class="title">博文</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/python/" class="nav-link router-link-active">
  Python
</a></li><li class="dropdown-item"><!----> <a href="/dv/" class="nav-link">
  Data Visualization
</a></li><li class="dropdown-item"><!----> <a href="/dl/" class="nav-link">
  Deep Learning
</a></li><li class="dropdown-item"><!----> <a href="/dc/" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/qa/" class="nav-link">
  Q&amp;A
</a></li><li class="dropdown-item"><!----> <a href="/svc/" class="nav-link">
  Backend Services
</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于
</a></div><div class="nav-item"><a href="https://www.github.com/bugwriter2" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="博文" class="dropdown-title"><span class="title">博文</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/python/" class="nav-link router-link-active">
  Python
</a></li><li class="dropdown-item"><!----> <a href="/dv/" class="nav-link">
  Data Visualization
</a></li><li class="dropdown-item"><!----> <a href="/dl/" class="nav-link">
  Deep Learning
</a></li><li class="dropdown-item"><!----> <a href="/dc/" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/qa/" class="nav-link">
  Q&amp;A
</a></li><li class="dropdown-item"><!----> <a href="/svc/" class="nav-link">
  Backend Services
</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于
</a></div><div class="nav-item"><a href="https://www.github.com/bugwriter2" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/python/Basics.html" class="sidebar-link">Basics</a></li><li><a href="/python/Web.html" class="sidebar-link">Web</a></li><li><a href="/python/NN.html" class="sidebar-link">Neural Networks</a></li><li><a href="/python/Test.html" aria-current="page" class="active sidebar-link">Test</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/python/Test.html#pytest" class="sidebar-link">pytest</a></li><li class="sidebar-sub-header"><a href="/python/Test.html#unittest" class="sidebar-link">unittest</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/python/Test.html#patch" class="sidebar-link">patch</a></li></ul></li><li class="sidebar-sub-header"><a href="/python/Test.html#coverage" class="sidebar-link">Coverage</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/python/Test.html#command" class="sidebar-link">command</a></li></ul></li></ul></li><li><a href="/python/PDF.html" class="sidebar-link">PDF</a></li><li><a href="/python/Coroutine.html" class="sidebar-link">Awaitable</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="test"><a href="#test" class="header-anchor">#</a> Test</h1> <h2 id="pytest"><a href="#pytest" class="header-anchor">#</a> pytest</h2> <ol><li><p>Schema</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> pytest

<span class="token keyword">def</span> <span class="token function">test_</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    This test function can be discovered
    &quot;&quot;&quot;</span>
    <span class="token keyword">pass</span>

<span class="token keyword">class</span> <span class="token class-name">MyClass</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    No __init__
    &quot;&quot;&quot;</span>
    <span class="token keyword">def</span> <span class="token function">test_sth</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        This test function (starts with test and self as parameter) can be discovered
        &quot;&quot;&quot;</span>
        <span class="token keyword">pass</span>
</code></pre></div></li> <li><p>Command line</p> <div class="language- extra-class"><pre class="language-text"><code>&gt; pytest ocr_test.py -k &quot;test_single_document_endpoint&quot;
</code></pre></div><blockquote><p>keyword expression <code>-k</code></p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>&gt; pytest ocr_test.py -k &quot;123 and not 456&quot;
</code></pre></div><blockquote><p>Runs 123.678 not 123.456</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>&gt; pytest ocr_test.py -k &quot;123 or 456&quot;
</code></pre></div><blockquote><p>Runs 123 and 456</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>&gt; touch repo/conftest.py

repo
├── conftest.py
├── app.py
├── settings.py
├── models.py
└── tests
    └── test_app.py
</code></pre></div><blockquote><p>pytest automatically adds PYTHONPATH as the path where conftest.py stays</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>&gt; pytest path/to/test_file.py::TestClass::test_method
</code></pre></div><blockquote><p>Runs one test method of a class</p></blockquote></li> <li><p>Parameterization
decorator</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># content of test_expectation.py</span>
<span class="token keyword">import</span> pytest

<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>mark<span class="token punctuation">.</span>parametrize</span><span class="token punctuation">(</span><span class="token string">&quot;test_input,expected&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">&quot;3+5&quot;</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&quot;2+4&quot;</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&quot;6*9&quot;</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">test_eval</span><span class="token punctuation">(</span>test_input<span class="token punctuation">,</span> expected<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">assert</span> <span class="token builtin">eval</span><span class="token punctuation">(</span>test_input<span class="token punctuation">)</span> <span class="token operator">==</span> expected
</code></pre></div><p><code>pytest_generate_tests</code></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># content of test_strings.py</span>

<span class="token keyword">def</span> <span class="token function">test_valid_string</span><span class="token punctuation">(</span>stringinput<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">assert</span> stringinput<span class="token punctuation">.</span>isalpha<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">pytest_generate_tests</span><span class="token punctuation">(</span>metafunc<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token string">&quot;stringinput&quot;</span> <span class="token keyword">in</span> metafunc<span class="token punctuation">.</span>fixturenames<span class="token punctuation">:</span>
        metafunc<span class="token punctuation">.</span>parametrize<span class="token punctuation">(</span><span class="token string">&quot;stringinput&quot;</span><span class="token punctuation">,</span> some_list<span class="token punctuation">)</span>
</code></pre></div></li> <li><p>Fixture scope</p> <p>Fixtures are created when first requested by a test, and are destroyed based on their scope:</p> <ul><li><code>function</code>: the default scope, the fixture is destroyed at the end of the test.</li> <li><code>class</code>: the fixture is destroyed during teardown of the last test in the class.</li> <li><code>module</code>: the fixture is destroyed during teardown of the last test in the module.</li> <li><code>package</code>: the fixture is destroyed during teardown of the last test in the package.</li> <li><code>session</code>: the fixture is destroyed at the end of the test session.</li></ul> <p>caveats: only fixture value is destroyed. internal code memory status is stable.</p> <div class="custom-block tip"><p class="custom-block-title">Fixture Availability</p> <ol><li>PyPI projects that match “pytest-*” are considered plugins and are listed automatically. Packages classified as inactive are excluded. <a href="https://docs.pytest.org/en/7.1.x/reference/plugin_list.html" target="_blank" rel="noopener noreferrer">Full list<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Fixture availability is determined from the perspective of the test. A fixture is only available for tests to request if they are <strong>in the scope that fixture is defined in</strong>. If a fixture is defined inside a class, it can only be requested by tests inside that class. But if a fixture is defined inside the global scope of the module, than every test in that module, even if it’s defined inside a class, can request it. <br> Similarly, a test can also only be affected by an autouse fixture if that test is in the same scope that autouse fixture is defined in (see Autouse fixtures are executed first within their scope).<br> A fixture can also request any other fixture, no matter where it’s defined, so long as the test requesting them can see all fixtures involved.</li></ol></div> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Apple</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>value <span class="token operator">=</span> count


<span class="token keyword">class</span> <span class="token class-name">SS</span><span class="token punctuation">:</span>
    instance <span class="token operator">=</span> <span class="token boolean">None</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

    <span class="token decorator annotation punctuation">@classmethod</span>
    <span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> cls<span class="token punctuation">.</span>instance <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            cls<span class="token punctuation">.</span>instance <span class="token operator">=</span> Apple<span class="token punctuation">(</span>count<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>cls<span class="token punctuation">.</span>instance<span class="token punctuation">)</span>
            cls<span class="token punctuation">.</span>instance <span class="token operator">=</span> Apple<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>

        <span class="token keyword">return</span> cls<span class="token punctuation">.</span>instance


<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>fixture</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># default teardown after each test function</span>
<span class="token keyword">def</span> <span class="token function">sston</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    guagua <span class="token operator">=</span> SS<span class="token punctuation">.</span>create<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> guagua


<span class="token keyword">class</span> <span class="token class-name">TestSS</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">test_one</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> sston<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">assert</span> sston<span class="token punctuation">.</span>value <span class="token operator">==</span> <span class="token number">20</span>

    <span class="token keyword">def</span> <span class="token function">test_two</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> sston<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">assert</span> sston<span class="token punctuation">.</span>value <span class="token operator">==</span> <span class="token number">10</span>  <span class="token comment"># SS.instance is still there</span>
</code></pre></div></li> <li><p>conftest.py</p> <p>In a wide meaning <code>conftest.py</code> is a local per-directory plugin. Here you define directory-specific hooks and fixtures.</p> <p>caveats</p> <ul><li>when testing, <code>conftest.py</code>s defined are imported and collected</li> <li>fixtures defined in the <code>conftest.py</code> in the same directory win</li></ul></li> <li><p>Practices</p> <p>6.1 mock requests</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># pytest register requests_mock as requests_mock.Mocker(real_http=False, session=None)</span>
<span class="token comment"># i.e., all requests are captured</span>
<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>fixture</span>
<span class="token keyword">def</span> <span class="token function">mock_a_request</span><span class="token punctuation">(</span>requests_mock<span class="token punctuation">)</span><span class="token punctuation">:</span>
    requests_mock<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
    requests_mock<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
    requests_mock<span class="token punctuation">.</span>register_uir<span class="token punctuation">(</span><span class="token string">'POST'</span><span class="token punctuation">,</span> <span class="token string">'mock://127.0.0.1'</span><span class="token punctuation">,</span> additional_matcher<span class="token operator">=</span><span class="token builtin">callable</span><span class="token punctuation">,</span> json<span class="token operator">=</span><span class="token builtin">callable</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">test_sth</span><span class="token punctuation">(</span>mock_a_request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div><p>6.2 MagicMock with monkeypatch</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token decorator annotation punctuation">@pytest_fixture</span>
<span class="token keyword">def</span> <span class="token function">mock_attribute</span><span class="token punctuation">(</span>monkeypatch<span class="token punctuation">)</span><span class="token punctuation">:</span>
    mock_sth <span class="token operator">=</span> MagicMock<span class="token punctuation">(</span><span class="token punctuation">)</span>
    mock_sth<span class="token punctuation">.</span>return_value <span class="token operator">=</span> <span class="token string">'sth'</span>
    monkeypatch<span class="token punctuation">.</span><span class="token builtin">setattr</span><span class="token punctuation">(</span>module<span class="token punctuation">,</span> <span class="token string">'attribute'</span><span class="token punctuation">,</span> mock_sth<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">test_sth</span><span class="token punctuation">(</span>mock_attribute<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token comment">############</span>
<span class="token comment"># Alterative</span>
<span class="token comment">############</span>
<span class="token keyword">def</span> <span class="token function">test_sth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> patch<span class="token punctuation">.</span><span class="token builtin">object</span><span class="token punctuation">(</span>module<span class="token punctuation">,</span> <span class="token string">'attribute'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> mock_sth<span class="token punctuation">:</span>  <span class="token comment"># a MagicMock</span>
        mock_sth<span class="token punctuation">.</span>return_value <span class="token operator">=</span> <span class="token string">'sth'</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div><p>6.3 mock local or remote model predictions:</p> <ul><li>mock function call</li> <li>mock tfs requests</li></ul></li> <li><p>Folder structure</p> <p><code>__init__.py</code> is needed to maintain a folder structure</p></li> <li><p><code>request</code></p> <div class="language-python extra-class"><pre class="language-python"><code>request<span class="token punctuation">.</span>getfixturevalue<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>logging</p> <ul><li><p><code>-s</code>: Stops hiding std_out/std_err for successful tests</p></li> <li><p><code>--log-cli-level=INFO</code>: Shows logs above INFO</p></li> <li><p><code>-p no:logging</code>: Turns off logging plugin</p></li></ul></li> <li><p><code>pytest-aiohttp</code></p> <p>by <code>pip install pytest-aiohttp</code> or <code>pytest_plugins = 'aiohttp.pytest_plugin'</code> in root <code>conftest.py</code></p> <p>async coroutines are runnable automatically</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">some_fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    r <span class="token operator">=</span> <span class="token keyword">await</span> a_fn<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">assert</span> r
</code></pre></div></li> <li><p><code>pytest-asyncio</code></p> <p>async coroutines are runnable with <code>@pytest.mark.asyncio</code></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>mark<span class="token punctuation">.</span>asyncio</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">some_fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    r <span class="token operator">=</span> <span class="token keyword">await</span> a_fn<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">assert</span> r
</code></pre></div><p>take care of contextvars usage</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> aiocontextvars
<span class="token keyword">class</span> <span class="token class-name">CM</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">__aenter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        c <span class="token operator">=</span> aiocontextvars<span class="token punctuation">.</span>_get_context<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>c <span class="token operator">=</span> c
        <span class="token keyword">return</span> <span class="token number">10</span>
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">__aexit__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> exc_type<span class="token punctuation">,</span> exc_val<span class="token punctuation">,</span> exc_tb<span class="token punctuation">)</span><span class="token punctuation">:</span>
        c2 <span class="token operator">=</span> aiocontextvars<span class="token punctuation">.</span>_get_context<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">assert</span> self<span class="token punctuation">.</span>c <span class="token operator">==</span> c2  <span class="token comment"># True</span>
        <span class="token keyword">assert</span> self<span class="token punctuation">.</span>c <span class="token keyword">is</span> c2  <span class="token comment"># False as pytest_asyncio handles aenter, aexit in two successive contexts, and the later is a copy of the former</span>

<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>fixture</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">some_fn_with_context_manager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">async</span> <span class="token keyword">with</span> CM<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span>

<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">test_debug</span><span class="token punctuation">(</span>some_fn_with_context_manager<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>  <span class="token comment"># tear_down fails</span>

<span class="token comment"># from https://github.com/pytest-dev/pytest-asyncio/issues/127</span>
<span class="token keyword">from</span> contextvars <span class="token keyword">import</span> ContextVar
<span class="token keyword">import</span> pytest
blah <span class="token operator">=</span> ContextVar<span class="token punctuation">(</span><span class="token string">&quot;blah&quot;</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>fixture</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">my_context_var</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    blah<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">assert</span> blah<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;hello&quot;</span>
    <span class="token keyword">yield</span> blah

<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>mark<span class="token punctuation">.</span>asyncio</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">test_blah</span><span class="token punctuation">(</span>my_context_var<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">assert</span> my_context_var<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;hello&quot;</span> <span class="token comment"># this fails, The cause appears to be that the async fixtures are ran in own Tasks.</span>
</code></pre></div></li> <li><p>celery</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">test_some_task</span><span class="token punctuation">(</span>celery_worker<span class="token punctuation">)</span><span class="token punctuation">:</span>
    some_task<span class="token punctuation">.</span>delay<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># if no celery worker, some_task hangs</span>
</code></pre></div></li> <li><p>parallel</p> <p>https://www.jetbrains.com/help/pycharm/performing-tests.html#test-mutliprocessing</p></li> <li><p>configuration</p> <p>Many pytest settings can be set in a configuration file, which by convention resides on the root of your repository or in your tests folder.</p> <p>example pytest.ini</p> <div class="language- extra-class"><pre class="language-text"><code>[pytest]
log_cli=true
log_level=DEBUG
</code></pre></div></li> <li><p>Issue with <code>ContextVars</code>
As discussed in <a href="https://github.com/pytest-dev/pytest-asyncio/issues/127" target="_blank" rel="noopener noreferrer">github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, <code>ContextVars</code> set before <code>yield</code> in pytest's fixture is quaranntined from real test code</p></li></ol> <h2 id="unittest"><a href="#unittest" class="header-anchor">#</a> unittest</h2> <p>unittest.mock wraps the outdated mock module since python 3.3</p> <h3 id="patch"><a href="#patch" class="header-anchor">#</a> patch</h3> <p>patch the correct item</p> <blockquote><p>If the function is used directly, instead of patching the original place where function is defined, patch the place where function is used.
<br>
If an attribute of an object is used, patching the place where the object is defined is okay (import is always the 1st step. patching before usage is important.).</p></blockquote> <div class="language-python extra-class"><pre class="language-python"><code><span class="token triple-quoted-string string">&quot;&quot;&quot;
myapp.py
&quot;&quot;&quot;</span>
<span class="token keyword">from</span> where<span class="token punctuation">.</span>method<span class="token punctuation">.</span>is_defined <span class="token keyword">import</span> standalone_method
<span class="token keyword">from</span> where<span class="token punctuation">.</span>anotherMethod<span class="token punctuation">.</span>is_defined <span class="token keyword">import</span> ObjectContainingThisMethod

<span class="token keyword">class</span> <span class="token class-name">MyApp</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>
    <span class="token keyword">def</span> <span class="token function">abc</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
       standalone_method<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># method is called directly</span>

    <span class="token keyword">def</span> <span class="token function">efg</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        obj <span class="token operator">=</span> ObjectContainingThisMethod<span class="token punctuation">(</span><span class="token punctuation">)</span>
        obj<span class="token punctuation">.</span>method<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># method is a class attribute</span>

</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code><span class="token triple-quoted-string string">&quot;&quot;&quot;
patch the correct item
&quot;&quot;&quot;</span>
<span class="token keyword">import</span> where<span class="token punctuation">.</span>method<span class="token punctuation">.</span>is_used<span class="token punctuation">.</span>MyApp

<span class="token keyword">def</span> <span class="token function">test_abc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">from</span> where<span class="token punctuation">.</span>method <span class="token keyword">import</span> is_used
    <span class="token keyword">with</span> patch<span class="token punctuation">.</span><span class="token builtin">object</span><span class="token punctuation">(</span>is_used<span class="token punctuation">,</span> <span class="token string">'standalone_method'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        myapp <span class="token operator">=</span> MyApp
        myapp<span class="token punctuation">.</span>abc<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># method is changed to mocked</span>

<span class="token keyword">def</span> <span class="token function">test_efg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">from</span> where<span class="token punctuation">.</span>anotherMethod<span class="token punctuation">.</span>is_defined <span class="token keyword">import</span> ObjectContainingThisMethod
    <span class="token keyword">with</span> patch<span class="token punctuation">.</span><span class="token builtin">object</span><span class="token punctuation">(</span>ObjectContainingThisMethod<span class="token punctuation">,</span> <span class="token string">'method'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        myapp <span class="token operator">=</span> MyApp
        myapp<span class="token punctuation">.</span>efg<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># method is changed to mocked</span>
</code></pre></div><p><code>patch</code>, <code>patch.dict</code>, or <code>patch.object</code> can act as a function decorator, class decorator or a context manager. When used as a class decorator, methods starting with patch.TEST_PREFIX are mocked.</p> <p><a href="https://docs.python.org/3/library/unittest.mock.html#unittest.mock.patch" target="_blank" rel="noopener noreferrer"><code>patch(target, new=DEFAULT, **kwargs)</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>if <code>new</code> is omitted, <code>AsyncMock</code> is generated for async target and <code>MagicMock</code> is generated for others</li> <li><code>target</code> must be string with the format <code>package.module.ClassName</code></li> <li>can only mock one module at that path, if the path is correct</li></ul> <p><a href="https://docs.python.org/3/library/unittest.mock.html#unittest.mock.patch.object" target="_blank" rel="noopener noreferrer"><code>patch.object(target, attribute, new=DEFAULT, **kwargs)</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>if <code>new</code> is omitted, <code>AsyncMock</code> is generated for async target and <code>MagicMock</code> is generated for others</li> <li>can only mock one module at that path, if the path is correct</li> <li>target must be imported in unit test for <code>patch.object</code> to work</li> <li><code>target</code> is python variable and <code>attribute</code> is string</li></ul> <p><a href="https://docs.python.org/3/library/unittest.mock.html#unittest.mock.patch.dict" target="_blank" rel="noopener noreferrer"><code>patch.dict(in_dict, values=(), clear=False, **kwargs)</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ul><li>modifies the dictionary everywhere</li> <li><code>in_dict</code> can be a string('package.module.dict') or python dict variable</li> <li><code>values</code> can be a dictionary or a iterable of <code>(key, value)</code> pairs</li> <li>if <code>clear</code> is true, <code>in_dict</code> is replaced. Otherwise, <code>in_dict</code> is updated</li> <li>since python 3.8, if used as context manager the mocked dict is returned</li> <li><code>in_dict</code> and the mocked dict(since 3.8) are restored back after test</li></ul> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># affects dictionary in moduleA, moduleB, ...</span>
<span class="token comment"># (target, value, clear)</span>
<span class="token comment"># clear: whether to empty the dictionary before overriding</span>
<span class="token comment"># target: imported or string</span>
<span class="token keyword">with</span> mock<span class="token punctuation">.</span>patch<span class="token punctuation">.</span><span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token string">'moduleA.dictionary'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'key'</span><span class="token punctuation">:</span><span class="token string">'value'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> clear<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>
<span class="token keyword">with</span> mock<span class="token punctuation">.</span>patch<span class="token punctuation">.</span><span class="token builtin">dict</span><span class="token punctuation">(</span>moduleA<span class="token punctuation">.</span>dictionary<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'key'</span><span class="token punctuation">:</span><span class="token string">'value'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> clear<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

<span class="token comment"># only affects moduleA</span>
<span class="token comment"># (target, attribute, value)</span>
<span class="token comment"># read_only attribute cannot be patched</span>
<span class="token keyword">with</span> mock<span class="token punctuation">.</span>patch<span class="token punctuation">.</span><span class="token builtin">object</span><span class="token punctuation">(</span>moduleA<span class="token punctuation">,</span> <span class="token string">'dictionary'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'key'</span><span class="token punctuation">:</span><span class="token string">'value'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

<span class="token comment"># only affects moduleA</span>
<span class="token comment"># (target, value)</span>
<span class="token comment"># target can be string or imported</span>
<span class="token keyword">with</span> mock<span class="token punctuation">.</span>patch<span class="token punctuation">(</span><span class="token string">'moduleA.dictionary'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'key'</span><span class="token punctuation">:</span><span class="token string">'value'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

<span class="token comment"># nested mock</span>
<span class="token keyword">with</span> mock<span class="token punctuation">.</span>patch<span class="token punctuation">(</span><span class="token string">'moduleA.dictionary'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'key'</span><span class="token punctuation">:</span><span class="token string">'value'</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token keyword">as</span> mock_a<span class="token punctuation">,</span> mock<span class="token punctuation">.</span>patch<span class="token punctuation">(</span><span class="token string">'moduleB.dictionary'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'key'</span><span class="token punctuation">:</span><span class="token string">'value'</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token keyword">as</span> mock_b<span class="token punctuation">:</span>
    <span class="token keyword">pass</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># patch.dict can also be used to mock environment variables</span>
<span class="token keyword">with</span> mock<span class="token punctuation">.</span>patch<span class="token punctuation">.</span><span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token string">'os.environ'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'hello'</span><span class="token punctuation">:</span> <span class="token string">'world'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> clear<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

<span class="token comment"># make patch a fixture</span>
<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>fixture</span><span class="token punctuation">(</span>autouse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">mock_settings_env_vars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> mock<span class="token punctuation">.</span>patch<span class="token punctuation">.</span><span class="token builtin">dict</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>environ<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">&quot;FROBNICATION_COLOUR&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;ROUGE&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">side_effect</p> <p><code>side_effect</code>: assign an exception, iterable, or function.</p> <ul><li>iterable: return in order</li> <li>function: pass in the arguments from original function</li></ul></div> <div class="custom-block tip"><p class="custom-block-title">handle class mock</p> <p>instance method with <code>self</code> needed a argument place, whereas class method with <code>cls</code> does not</p></div> <h2 id="coverage"><a href="#coverage" class="header-anchor">#</a> Coverage</h2> <p>Only importable files (ones at the root of the tree, or in directories with a <strong>init</strong>.py file) will be considered.</p> <h3 id="command"><a href="#command" class="header-anchor">#</a> command</h3> <div class="language-python extra-class"><pre class="language-python"><code>pytest <span class="token operator">-</span><span class="token operator">-</span>cov<span class="token operator">-</span>report term <span class="token operator">-</span><span class="token operator">-</span>cov<span class="token operator">=</span>apple <span class="token operator">-</span><span class="token operator">-</span>cov<span class="token operator">=</span>orange apple_tests


<span class="token triple-quoted-string string">&quot;&quot;&quot;
---------- coverage: python ----------
Name                                        Stmts   Miss  Cover
---------------------------------------------------------------
apple/aaaaaaaaaa.py                       41      9    78%
apple/bbbbbbbbbbbbbbb.py                  48     13    73%
---------------------------------------------------------------
TOTAL                                     89     22    75%
&quot;&quot;&quot;</span>
</code></pre></div><p>or</p> <div class="language-text extra-class"><pre class="language-text"><code>[run]
source = apple,orange
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>python <span class="token operator">-</span><span class="token operator">-</span>cov<span class="token operator">-</span>config<span class="token operator">=</span><span class="token punctuation">.</span>coveragerc <span class="token operator">-</span><span class="token operator">-</span>cov<span class="token operator">-</span>report term <span class="token operator">-</span><span class="token operator">-</span>cov apple_tests
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2/1/2024, 4:22:58 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/python/NN.html" class="prev">
        Neural Networks
      </a></span> <span class="next"><a href="/python/PDF.html">
        PDF
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.3fa2a2e1.js" defer></script><script src="/assets/js/2.057925ea.js" defer></script><script src="/assets/js/35.2828b1d3.js" defer></script>
  </body>
</html>
